import*as O from"node:tty";import{existsSync as T,mkdirSync as z,cpSync as V,renameSync as Y}from"fs";import{dirname as J,join as S}from"path";import{fileURLToPath as K}from"url";const g={fatal:0,error:0,warn:1,log:2,info:3,success:3,fail:3,debug:4,trace:5,verbose:Number.POSITIVE_INFINITY},E={silent:{level:-1},fatal:{level:g.fatal},error:{level:g.error},warn:{level:g.warn},log:{level:g.log},info:{level:g.info},success:{level:g.success},fail:{level:g.fail},ready:{level:g.info},start:{level:g.info},box:{level:g.info},debug:{level:g.debug},trace:{level:g.trace},verbose:{level:g.verbose}};function x(t){if(t===null||typeof t!="object")return!1;const e=Object.getPrototypeOf(t);return e!==null&&e!==Object.prototype&&Object.getPrototypeOf(e)!==null||Symbol.iterator in t?!1:Symbol.toStringTag in t?Object.prototype.toString.call(t)==="[object Module]":!0}function $(t,e,o=".",n){if(!x(e))return $(t,{},o);const r=Object.assign({},e);for(const s in t){if(s==="__proto__"||s==="constructor")continue;const l=t[s];l!=null&&(Array.isArray(l)&&Array.isArray(r[s])?r[s]=[...l,...r[s]]:x(l)&&x(r[s])?r[s]=$(l,r[s],(o?`${o}.`:"")+s.toString()):r[s]=l)}return r}function Q(t){return(...e)=>e.reduce((o,n)=>$(o,n,""),{})}const X=Q();function Z(t){return Object.prototype.toString.call(t)==="[object Object]"}function ee(t){return!(!Z(t)||!t.message&&!t.args||t.stack)}let M=!1;const N=[];class h{options;_lastLog;_mockFn;constructor(e={}){const o=e.types||E;this.options=X({...e,defaults:{...e.defaults},level:B(e.level,o),reporters:[...e.reporters||[]]},{types:E,throttle:1e3,throttleMin:5,formatOptions:{date:!0,colors:!1,compact:!0}});for(const n in o){const r={type:n,...this.options.defaults,...o[n]};this[n]=this._wrapLogFn(r),this[n].raw=this._wrapLogFn(r,!0)}this.options.mockFn&&this.mockTypes(),this._lastLog={}}get level(){return this.options.level}set level(e){this.options.level=B(e,this.options.types,this.options.level)}prompt(e,o){if(!this.options.prompt)throw new Error("prompt is not supported!");return this.options.prompt(e,o)}create(e){const o=new h({...this.options,...e});return this._mockFn&&o.mockTypes(this._mockFn),o}withDefaults(e){return this.create({...this.options,defaults:{...this.options.defaults,...e}})}withTag(e){return this.withDefaults({tag:this.options.defaults.tag?this.options.defaults.tag+":"+e:e})}addReporter(e){return this.options.reporters.push(e),this}removeReporter(e){if(e){const o=this.options.reporters.indexOf(e);if(o!==-1)return this.options.reporters.splice(o,1)}else this.options.reporters.splice(0);return this}setReporters(e){return this.options.reporters=Array.isArray(e)?e:[e],this}wrapAll(){this.wrapConsole(),this.wrapStd()}restoreAll(){this.restoreConsole(),this.restoreStd()}wrapConsole(){for(const e in this.options.types)console["__"+e]||(console["__"+e]=console[e]),console[e]=this[e].raw}restoreConsole(){for(const e in this.options.types)console["__"+e]&&(console[e]=console["__"+e],delete console["__"+e])}wrapStd(){this._wrapStream(this.options.stdout,"log"),this._wrapStream(this.options.stderr,"log")}_wrapStream(e,o){e&&(e.__write||(e.__write=e.write),e.write=n=>{this[o].raw(String(n).trim())})}restoreStd(){this._restoreStream(this.options.stdout),this._restoreStream(this.options.stderr)}_restoreStream(e){e&&e.__write&&(e.write=e.__write,delete e.__write)}pauseLogs(){M=!0}resumeLogs(){M=!1;const e=N.splice(0);for(const o of e)o[0]._logFn(o[1],o[2])}mockTypes(e){const o=e||this.options.mockFn;if(this._mockFn=o,typeof o=="function")for(const n in this.options.types)this[n]=o(n,this.options.types[n])||this[n],this[n].raw=this[n]}_wrapLogFn(e,o){return(...n)=>{if(M){N.push([this,e,n,o]);return}return this._logFn(e,n,o)}}_logFn(e,o,n){if((e.level||0)>this.level)return!1;const r={date:new Date,args:[],...e,level:B(e.level,this.options.types)};!n&&o.length===1&&ee(o[0])?Object.assign(r,o[0]):r.args=[...o],r.message&&(r.args.unshift(r.message),delete r.message),r.additional&&(Array.isArray(r.additional)||(r.additional=r.additional.split(`
`)),r.args.push(`
`+r.additional.join(`
`)),delete r.additional),r.type=typeof r.type=="string"?r.type.toLowerCase():"log",r.tag=typeof r.tag=="string"?r.tag:"";const s=(i=!1)=>{const a=(this._lastLog.count||0)-this.options.throttleMin;if(this._lastLog.object&&a>0){const u=[...this._lastLog.object.args];a>1&&u.push(`(repeated ${a} times)`),this._log({...this._lastLog.object,args:u}),this._lastLog.count=1}i&&(this._lastLog.object=r,this._log(r))};clearTimeout(this._lastLog.timeout);const l=this._lastLog.time&&r.date?r.date.getTime()-this._lastLog.time.getTime():0;if(this._lastLog.time=r.date,l<this.options.throttle)try{const i=JSON.stringify([r.type,r.tag,r.args]),a=this._lastLog.serialized===i;if(this._lastLog.serialized=i,a&&(this._lastLog.count=(this._lastLog.count||0)+1,this._lastLog.count>this.options.throttleMin)){this._lastLog.timeout=setTimeout(s,this.options.throttle);return}}catch{}s(!0)}_log(e){for(const o of this.options.reporters)o.log(e,{options:this.options})}}function B(t,e={},o=3){return t===void 0?o:typeof t=="number"?t:e[t]&&e[t].level!==void 0?e[t].level:o}h.prototype.add=h.prototype.addReporter,h.prototype.remove=h.prototype.removeReporter,h.prototype.clear=h.prototype.removeReporter,h.prototype.withScope=h.prototype.withTag,h.prototype.mock=h.prototype.mockTypes,h.prototype.pause=h.prototype.pauseLogs,h.prototype.resume=h.prototype.resumeLogs;function te(t={}){return new h(t)}class oe{options;defaultColor;levelColorMap;typeColorMap;constructor(e){this.options={...e},this.defaultColor="#7f8c8d",this.levelColorMap={0:"#c0392b",1:"#f39c12",3:"#00BCD4"},this.typeColorMap={success:"#2ecc71"}}_getLogFn(e){return e<1?console.__error||console.error:e===1?console.__warn||console.warn:console.__log||console.log}log(e){const o=this._getLogFn(e.level),n=e.type==="log"?"":e.type,r=e.tag||"",l=`
      background: ${this.typeColorMap[e.type]||this.levelColorMap[e.level]||this.defaultColor};
      border-radius: 0.5em;
      color: white;
      font-weight: bold;
      padding: 2px 0.5em;
    `,i=`%c${[r,n].filter(Boolean).join(":")}`;typeof e.args[0]=="string"?o(`${i}%c ${e.args[0]}`,l,"",...e.args.slice(1)):o(i,l,...e.args)}}function re(t={}){return te({reporters:t.reporters||[new oe({})],prompt(o,n={}){return n.type==="confirm"?Promise.resolve(confirm(o)):Promise.resolve(prompt(o))},...t})}const w=re(),{env:_={},argv:I=[],platform:ne=""}=typeof process>"u"?{}:process,se="NO_COLOR"in _||I.includes("--no-color"),ie="FORCE_COLOR"in _||I.includes("--color"),ae=ne==="win32",F=_.TERM==="dumb",le=O&&O.isatty&&O.isatty(1)&&_.TERM&&!F,ce="CI"in _&&("GITHUB_ACTIONS"in _||"GITLAB_CI"in _||"CIRCLECI"in _),ue=!se&&(ie||ae&&!F||le||ce);function U(t,e,o,n,r=e.slice(0,Math.max(0,t))+n,s=e.slice(Math.max(0,t+o.length)),l=s.indexOf(o)){return r+(l<0?s:U(l,s,o,n))}function fe(t,e,o,n,r){return t<0?o+e+n:o+U(t,e,n,r)+n}function pe(t,e,o=t,n=t.length+1){return r=>r||!(r===""||r===void 0)?fe((""+r).indexOf(e,n),r,t,e,o):""}function c(t,e,o){return pe(`\x1B[${t}m`,`\x1B[${e}m`,o)}const P={reset:c(0,0),bold:c(1,22,"\x1B[22m\x1B[1m"),dim:c(2,22,"\x1B[22m\x1B[2m"),italic:c(3,23),underline:c(4,24),inverse:c(7,27),hidden:c(8,28),strikethrough:c(9,29),black:c(30,39),red:c(31,39),green:c(32,39),yellow:c(33,39),blue:c(34,39),magenta:c(35,39),cyan:c(36,39),white:c(37,39),gray:c(90,39),bgBlack:c(40,49),bgRed:c(41,49),bgGreen:c(42,49),bgYellow:c(43,49),bgBlue:c(44,49),bgMagenta:c(45,49),bgCyan:c(46,49),bgWhite:c(47,49),blackBright:c(90,39),redBright:c(91,39),greenBright:c(92,39),yellowBright:c(93,39),blueBright:c(94,39),magentaBright:c(95,39),cyanBright:c(96,39),whiteBright:c(97,39),bgBlackBright:c(100,49),bgRedBright:c(101,49),bgGreenBright:c(102,49),bgYellowBright:c(103,49),bgBlueBright:c(104,49),bgMagentaBright:c(105,49),bgCyanBright:c(106,49),bgWhiteBright:c(107,49)};function he(t=ue){return t?P:Object.fromEntries(Object.keys(P).map(e=>[e,String]))}const b=he();function ge(t){return Array.isArray(t)?t:t===void 0?[]:[t]}function j(t,e=""){const o=[];for(const n of t)for(const[r,s]of n.entries())o[r]=Math.max(o[r]||0,s.length);return t.map(n=>n.map((r,s)=>e+r[s===0?"padStart":"padEnd"](o[s])).join("  ")).join(`
`)}function m(t){return typeof t=="function"?t():t}class v extends Error{constructor(e,o){super(e),this.code=o,this.name="CLIError"}}const de=/\d/,me=["-","_","/","."];function ye(t=""){if(!de.test(t))return t!==t.toLowerCase()}function D(t,e){const o=me,n=[];if(!t||typeof t!="string")return n;let r="",s,l;for(const i of t){const a=o.includes(i);if(a===!0){n.push(r),r="",s=void 0;continue}const u=ye(i);if(l===!1){if(s===!1&&u===!0){n.push(r),r=i,s=u;continue}if(s===!0&&u===!1&&r.length>1){const p=r.at(-1);n.push(r.slice(0,Math.max(0,r.length-1))),r=p+i,s=u;continue}}r+=i,s=u,l=a}return n.push(r),n}function we(t){return t?t[0].toUpperCase()+t.slice(1):""}function be(t){return t?t[0].toLowerCase()+t.slice(1):""}function _e(t,e){return t?(Array.isArray(t)?t:D(t)).map(o=>we(o)).join(""):""}function Ce(t,e){return be(_e(t||""))}function ve(t,e){return t?(Array.isArray(t)?t:D(t)).map(o=>o.toLowerCase()).join("-"):""}function k(t){return t==null?[]:Array.isArray(t)?t:[t]}function Le(t,e,o,n){let r;const s=t[e],l=~n.string.indexOf(e)?o==null||o===!0?"":String(o):typeof o=="boolean"?o:~n.boolean.indexOf(e)?o==="false"?!1:o==="true"||(t._.push((r=+o,r*0===0?r:o)),!!o):(r=+o,r*0===0?r:o);t[e]=s==null?l:Array.isArray(s)?s.concat(l):[s,l]}function Ae(t=[],e={}){let o,n,r,s,l;const i={_:[]};let a=0,u=0,p=0;const L=t.length,A=e.alias!==void 0,f=e.unknown!==void 0,d=e.default!==void 0;if(e.alias=e.alias||{},e.string=k(e.string),e.boolean=k(e.boolean),A)for(o in e.alias)for(n=e.alias[o]=k(e.alias[o]),a=0;a<n.length;a++)(e.alias[n[a]]=n.concat(o)).splice(a,1);for(a=e.boolean.length;a-- >0;)for(n=e.alias[e.boolean[a]]||[],u=n.length;u-- >0;)e.boolean.push(n[u]);for(a=e.string.length;a-- >0;)for(n=e.alias[e.string[a]]||[],u=n.length;u-- >0;)e.string.push(n[u]);if(d){for(o in e.default)if(s=typeof e.default[o],n=e.alias[o]=e.alias[o]||[],e[s]!==void 0)for(e[s].push(o),a=0;a<n.length;a++)e[s].push(n[a])}const y=f?Object.keys(e.alias):[];for(a=0;a<L;a++){if(r=t[a],r==="--"){i._=i._.concat(t.slice(++a));break}for(u=0;u<r.length&&r.charCodeAt(u)===45;u++);if(u===0)i._.push(r);else if(r.substring(u,u+3)==="no-"){if(s=r.slice(Math.max(0,u+3)),f&&!~y.indexOf(s))return e.unknown(r);i[s]=!1}else{for(p=u+1;p<r.length&&r.charCodeAt(p)!==61;p++);for(s=r.substring(u,p),l=r.slice(Math.max(0,++p))||a+1===L||(""+t[a+1]).charCodeAt(0)===45||t[++a],n=u===2?[s]:s,p=0;p<n.length;p++){if(s=n[p],f&&!~y.indexOf(s))return e.unknown("-".repeat(u)+s);Le(i,s,p+1<n.length||l,e)}}}if(d)for(o in e.default)i[o]===void 0&&(i[o]=e.default[o]);if(A)for(o in i)for(n=e.alias[o]||[];n.length>0;)i[n.shift()]=i[o];return i}function Se(t,e){const o={boolean:[],string:[],mixed:[],alias:{},default:{}},n=q(e);for(const i of n)i.type!=="positional"&&(i.type==="string"?o.string.push(i.name):i.type==="boolean"&&o.boolean.push(i.name),i.default!==void 0&&(o.default[i.name]=i.default),i.alias&&(o.alias[i.name]=i.alias));const r=Ae(t,o),[...s]=r._,l=new Proxy(r,{get(i,a){return i[a]??i[Ce(a)]??i[ve(a)]}});for(const[,i]of n.entries())if(i.type==="positional"){const a=s.shift();if(a!==void 0)l[i.name]=a;else{if(i.default===void 0&&i.required!==!1)throw new v(`Missing required positional argument: ${i.name.toUpperCase()}`,"EARG");l[i.name]=i.default}}else if(i.required&&l[i.name]===void 0)throw new v(`Missing required argument: --${i.name}`,"EARG");return l}function q(t){const e=[];for(const[o,n]of Object.entries(t||{}))e.push({...n,name:o,alias:ge(n.alias)});return e}function Ee(t){return t}async function G(t,e){const o=await m(t.args||{}),n=Se(e.rawArgs,o),r={rawArgs:e.rawArgs,args:n,data:e.data,cmd:t};typeof t.setup=="function"&&await t.setup(r);let s;try{const l=await m(t.subCommands);if(l&&Object.keys(l).length>0){const i=e.rawArgs.findIndex(u=>!u.startsWith("-")),a=e.rawArgs[i];if(a){if(!l[a])throw new v(`Unknown command \`${a}\``,"E_UNKNOWN_COMMAND");const u=await m(l[a]);u&&await G(u,{rawArgs:e.rawArgs.slice(i+1)})}else if(!t.run)throw new v("No command specified.","E_NO_COMMAND")}typeof t.run=="function"&&(s=await t.run(r))}finally{typeof t.cleanup=="function"&&await t.cleanup(r)}return{result:s}}async function R(t,e,o){const n=await m(t.subCommands);if(n&&Object.keys(n).length>0){const r=e.findIndex(i=>!i.startsWith("-")),s=e[r],l=await m(n[s]);if(l)return R(l,e.slice(r+1),t)}return[t,o]}async function Oe(t,e){try{w.log(await xe(t,e)+`
`)}catch(o){w.error(o)}}async function xe(t,e){const o=await m(t.meta||{}),n=q(await m(t.args||{})),r=await m(e?.meta||{}),s=`${r.name?`${r.name} `:""}`+(o.name||process.argv[1]),l=[],i=[],a=[],u=[];for(const f of n)if(f.type==="positional"){const d=f.name.toUpperCase(),y=f.required!==!1&&f.default===void 0,C=f.default?`="${f.default}"`:"";i.push(["`"+d+C+"`",f.description||"",f.valueHint?`<${f.valueHint}>`:""]),u.push(y?`<${d}>`:`[${d}]`)}else{const d=f.required===!0&&f.default===void 0,y=(f.type==="boolean"&&f.default===!0?[...(f.alias||[]).map(C=>`--no-${C}`),`--no-${f.name}`].join(", "):[...(f.alias||[]).map(C=>`-${C}`),`--${f.name}`].join(", "))+(f.type==="string"&&(f.valueHint||f.default)?`=${f.valueHint?`<${f.valueHint}>`:`"${f.default||""}"`}`:"");l.push(["`"+y+(d?" (required)":"")+"`",f.description||""]),d&&u.push(y)}if(t.subCommands){const f=[],d=await m(t.subCommands);for(const[y,C]of Object.entries(d)){const H=await m(C),W=await m(H?.meta);a.push([`\`${y}\``,W?.description||""]),f.push(y)}u.push(f.join("|"))}const p=[],L=o.version||r.version;p.push(b.gray(`${o.description} (${s+(L?` v${L}`:"")})`),"");const A=l.length>0||i.length>0;return p.push(`${b.underline(b.bold("USAGE"))} \`${s}${A?" [OPTIONS]":""} ${u.join(" ")}\``,""),i.length>0&&(p.push(b.underline(b.bold("ARGUMENTS")),""),p.push(j(i,"  ")),p.push("")),l.length>0&&(p.push(b.underline(b.bold("OPTIONS")),""),p.push(j(l,"  ")),p.push("")),a.length>0&&(p.push(b.underline(b.bold("COMMANDS")),""),p.push(j(a,"  ")),p.push("",`Use \`${s} <command> --help\` for more information about a command.`)),p.filter(f=>typeof f=="string").join(`
`)}async function $e(t,e={}){const o=e.rawArgs||process.argv.slice(2),n=e.showUsage||Oe;try{if(o.includes("--help")||o.includes("-h"))await n(...await R(t,o)),process.exit(0);else if(o.length===1&&o[0]==="--version"){const r=typeof t.meta=="function"?await t.meta():await t.meta;if(!r?.version)throw new v("No version specified","E_NO_VERSION");w.log(r.version)}else await G(t,{rawArgs:o})}catch(r){const s=r instanceof v;s||w.error(r,`
`),s&&await n(...await R(t,o)),w.error(r.message),process.exit(1)}}const Me=K(import.meta.url),Be=J(Me),je={meta:{name:"Create Reactmos Module",version:"0.1.0",description:"Create a extendable React Module"},args:{name:{type:"positional",description:"Project name",required:!0}},run({args:t}){w.info("Create consola");const e=S(process.cwd(),t.name);T(e)&&(w.error(`Dir ${t.name} already exists.`),process.exit(1)),z(e,{recursive:!0}),w.start("\u{1F4E6} Copying files...");const o=S(Be,"../template");V(o,e,{recursive:!0}),Object.entries({_gitignore:".gitignore",_npmrc:".npmrc"}).forEach(([n,r])=>{const s=S(e,n),l=S(e,r);T(s)&&Y(s,l)}),w.success("Project created!")}};$e(je);
