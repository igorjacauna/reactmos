import*as S from"node:tty";import{execSync as W}from"child_process";import{existsSync as z,mkdirSync as V,cpSync as Y}from"fs";import{dirname as J,join as R}from"path";import{fileURLToPath as K}from"url";const g={fatal:0,error:0,warn:1,log:2,info:3,success:3,fail:3,debug:4,trace:5,verbose:Number.POSITIVE_INFINITY},T={silent:{level:-1},fatal:{level:g.fatal},error:{level:g.error},warn:{level:g.warn},log:{level:g.log},info:{level:g.info},success:{level:g.success},fail:{level:g.fail},ready:{level:g.info},start:{level:g.info},box:{level:g.info},debug:{level:g.debug},trace:{level:g.trace},verbose:{level:g.verbose}};function x(t){if(t===null||typeof t!="object")return!1;const e=Object.getPrototypeOf(t);return e!==null&&e!==Object.prototype&&Object.getPrototypeOf(e)!==null||Symbol.iterator in t?!1:Symbol.toStringTag in t?Object.prototype.toString.call(t)==="[object Module]":!0}function O(t,e,o=".",r){if(!x(e))return O(t,{},o);const n=Object.assign({},e);for(const s in t){if(s==="__proto__"||s==="constructor")continue;const l=t[s];l!=null&&(Array.isArray(l)&&Array.isArray(n[s])?n[s]=[...l,...n[s]]:x(l)&&x(n[s])?n[s]=O(l,n[s],(o?`${o}.`:"")+s.toString()):n[s]=l)}return n}function Q(t){return(...e)=>e.reduce((o,r)=>O(o,r,""),{})}const X=Q();function Z(t){return Object.prototype.toString.call(t)==="[object Object]"}function ee(t){return!(!Z(t)||!t.message&&!t.args||t.stack)}let $=!1;const E=[];class h{options;_lastLog;_mockFn;constructor(e={}){const o=e.types||T;this.options=X({...e,defaults:{...e.defaults},level:M(e.level,o),reporters:[...e.reporters||[]]},{types:T,throttle:1e3,throttleMin:5,formatOptions:{date:!0,colors:!1,compact:!0}});for(const r in o){const n={type:r,...this.options.defaults,...o[r]};this[r]=this._wrapLogFn(n),this[r].raw=this._wrapLogFn(n,!0)}this.options.mockFn&&this.mockTypes(),this._lastLog={}}get level(){return this.options.level}set level(e){this.options.level=M(e,this.options.types,this.options.level)}prompt(e,o){if(!this.options.prompt)throw new Error("prompt is not supported!");return this.options.prompt(e,o)}create(e){const o=new h({...this.options,...e});return this._mockFn&&o.mockTypes(this._mockFn),o}withDefaults(e){return this.create({...this.options,defaults:{...this.options.defaults,...e}})}withTag(e){return this.withDefaults({tag:this.options.defaults.tag?this.options.defaults.tag+":"+e:e})}addReporter(e){return this.options.reporters.push(e),this}removeReporter(e){if(e){const o=this.options.reporters.indexOf(e);if(o!==-1)return this.options.reporters.splice(o,1)}else this.options.reporters.splice(0);return this}setReporters(e){return this.options.reporters=Array.isArray(e)?e:[e],this}wrapAll(){this.wrapConsole(),this.wrapStd()}restoreAll(){this.restoreConsole(),this.restoreStd()}wrapConsole(){for(const e in this.options.types)console["__"+e]||(console["__"+e]=console[e]),console[e]=this[e].raw}restoreConsole(){for(const e in this.options.types)console["__"+e]&&(console[e]=console["__"+e],delete console["__"+e])}wrapStd(){this._wrapStream(this.options.stdout,"log"),this._wrapStream(this.options.stderr,"log")}_wrapStream(e,o){e&&(e.__write||(e.__write=e.write),e.write=r=>{this[o].raw(String(r).trim())})}restoreStd(){this._restoreStream(this.options.stdout),this._restoreStream(this.options.stderr)}_restoreStream(e){e&&e.__write&&(e.write=e.__write,delete e.__write)}pauseLogs(){$=!0}resumeLogs(){$=!1;const e=E.splice(0);for(const o of e)o[0]._logFn(o[1],o[2])}mockTypes(e){const o=e||this.options.mockFn;if(this._mockFn=o,typeof o=="function")for(const r in this.options.types)this[r]=o(r,this.options.types[r])||this[r],this[r].raw=this[r]}_wrapLogFn(e,o){return(...r)=>{if($){E.push([this,e,r,o]);return}return this._logFn(e,r,o)}}_logFn(e,o,r){if((e.level||0)>this.level)return!1;const n={date:new Date,args:[],...e,level:M(e.level,this.options.types)};!r&&o.length===1&&ee(o[0])?Object.assign(n,o[0]):n.args=[...o],n.message&&(n.args.unshift(n.message),delete n.message),n.additional&&(Array.isArray(n.additional)||(n.additional=n.additional.split(`
`)),n.args.push(`
`+n.additional.join(`
`)),delete n.additional),n.type=typeof n.type=="string"?n.type.toLowerCase():"log",n.tag=typeof n.tag=="string"?n.tag:"";const s=(i=!1)=>{const a=(this._lastLog.count||0)-this.options.throttleMin;if(this._lastLog.object&&a>0){const u=[...this._lastLog.object.args];a>1&&u.push(`(repeated ${a} times)`),this._log({...this._lastLog.object,args:u}),this._lastLog.count=1}i&&(this._lastLog.object=n,this._log(n))};clearTimeout(this._lastLog.timeout);const l=this._lastLog.time&&n.date?n.date.getTime()-this._lastLog.time.getTime():0;if(this._lastLog.time=n.date,l<this.options.throttle)try{const i=JSON.stringify([n.type,n.tag,n.args]),a=this._lastLog.serialized===i;if(this._lastLog.serialized=i,a&&(this._lastLog.count=(this._lastLog.count||0)+1,this._lastLog.count>this.options.throttleMin)){this._lastLog.timeout=setTimeout(s,this.options.throttle);return}}catch{}s(!0)}_log(e){for(const o of this.options.reporters)o.log(e,{options:this.options})}}function M(t,e={},o=3){return t===void 0?o:typeof t=="number"?t:e[t]&&e[t].level!==void 0?e[t].level:o}h.prototype.add=h.prototype.addReporter,h.prototype.remove=h.prototype.removeReporter,h.prototype.clear=h.prototype.removeReporter,h.prototype.withScope=h.prototype.withTag,h.prototype.mock=h.prototype.mockTypes,h.prototype.pause=h.prototype.pauseLogs,h.prototype.resume=h.prototype.resumeLogs;function te(t={}){return new h(t)}class oe{options;defaultColor;levelColorMap;typeColorMap;constructor(e){this.options={...e},this.defaultColor="#7f8c8d",this.levelColorMap={0:"#c0392b",1:"#f39c12",3:"#00BCD4"},this.typeColorMap={success:"#2ecc71"}}_getLogFn(e){return e<1?console.__error||console.error:e===1?console.__warn||console.warn:console.__log||console.log}log(e){const o=this._getLogFn(e.level),r=e.type==="log"?"":e.type,n=e.tag||"",l=`
      background: ${this.typeColorMap[e.type]||this.levelColorMap[e.level]||this.defaultColor};
      border-radius: 0.5em;
      color: white;
      font-weight: bold;
      padding: 2px 0.5em;
    `,i=`%c${[n,r].filter(Boolean).join(":")}`;typeof e.args[0]=="string"?o(`${i}%c ${e.args[0]}`,l,"",...e.args.slice(1)):o(i,l,...e.args)}}function ne(t={}){return te({reporters:t.reporters||[new oe({})],prompt(o,r={}){return r.type==="confirm"?Promise.resolve(confirm(o)):Promise.resolve(prompt(o))},...t})}const m=ne(),{env:_={},argv:I=[],platform:re=""}=typeof process>"u"?{}:process,se="NO_COLOR"in _||I.includes("--no-color"),ie="FORCE_COLOR"in _||I.includes("--color"),ae=re==="win32",N=_.TERM==="dumb",le=S&&S.isatty&&S.isatty(1)&&_.TERM&&!N,ce="CI"in _&&("GITHUB_ACTIONS"in _||"GITLAB_CI"in _||"CIRCLECI"in _),ue=!se&&(ie||ae&&!N||le||ce);function F(t,e,o,r,n=e.slice(0,Math.max(0,t))+r,s=e.slice(Math.max(0,t+o.length)),l=s.indexOf(o)){return n+(l<0?s:F(l,s,o,r))}function fe(t,e,o,r,n){return t<0?o+e+r:o+F(t,e,r,n)+r}function pe(t,e,o=t,r=t.length+1){return n=>n||!(n===""||n===void 0)?fe((""+n).indexOf(e,r),n,t,e,o):""}function c(t,e,o){return pe(`\x1B[${t}m`,`\x1B[${e}m`,o)}const U={reset:c(0,0),bold:c(1,22,"\x1B[22m\x1B[1m"),dim:c(2,22,"\x1B[22m\x1B[2m"),italic:c(3,23),underline:c(4,24),inverse:c(7,27),hidden:c(8,28),strikethrough:c(9,29),black:c(30,39),red:c(31,39),green:c(32,39),yellow:c(33,39),blue:c(34,39),magenta:c(35,39),cyan:c(36,39),white:c(37,39),gray:c(90,39),bgBlack:c(40,49),bgRed:c(41,49),bgGreen:c(42,49),bgYellow:c(43,49),bgBlue:c(44,49),bgMagenta:c(45,49),bgCyan:c(46,49),bgWhite:c(47,49),blackBright:c(90,39),redBright:c(91,39),greenBright:c(92,39),yellowBright:c(93,39),blueBright:c(94,39),magentaBright:c(95,39),cyanBright:c(96,39),whiteBright:c(97,39),bgBlackBright:c(100,49),bgRedBright:c(101,49),bgGreenBright:c(102,49),bgYellowBright:c(103,49),bgBlueBright:c(104,49),bgMagentaBright:c(105,49),bgCyanBright:c(106,49),bgWhiteBright:c(107,49)};function he(t=ue){return t?U:Object.fromEntries(Object.keys(U).map(e=>[e,String]))}const b=he();function ge(t){return Array.isArray(t)?t:t===void 0?[]:[t]}function B(t,e=""){const o=[];for(const r of t)for(const[n,s]of r.entries())o[n]=Math.max(o[n]||0,s.length);return t.map(r=>r.map((n,s)=>e+n[s===0?"padStart":"padEnd"](o[s])).join("  ")).join(`
`)}function y(t){return typeof t=="function"?t():t}class v extends Error{constructor(e,o){super(e),this.code=o,this.name="CLIError"}}const de=/\d/,me=["-","_","/","."];function ye(t=""){if(!de.test(t))return t!==t.toLowerCase()}function P(t,e){const o=me,r=[];if(!t||typeof t!="string")return r;let n="",s,l;for(const i of t){const a=o.includes(i);if(a===!0){r.push(n),n="",s=void 0;continue}const u=ye(i);if(l===!1){if(s===!1&&u===!0){r.push(n),n=i,s=u;continue}if(s===!0&&u===!1&&n.length>1){const p=n.at(-1);r.push(n.slice(0,Math.max(0,n.length-1))),n=p+i,s=u;continue}}n+=i,s=u,l=a}return r.push(n),r}function we(t){return t?t[0].toUpperCase()+t.slice(1):""}function be(t){return t?t[0].toLowerCase()+t.slice(1):""}function _e(t,e){return t?(Array.isArray(t)?t:P(t)).map(o=>we(o)).join(""):""}function Ce(t,e){return be(_e(t||""))}function ve(t,e){return t?(Array.isArray(t)?t:P(t)).map(o=>o.toLowerCase()).join("-"):""}function j(t){return t==null?[]:Array.isArray(t)?t:[t]}function Le(t,e,o,r){let n;const s=t[e],l=~r.string.indexOf(e)?o==null||o===!0?"":String(o):typeof o=="boolean"?o:~r.boolean.indexOf(e)?o==="false"?!1:o==="true"||(t._.push((n=+o,n*0===0?n:o)),!!o):(n=+o,n*0===0?n:o);t[e]=s==null?l:Array.isArray(s)?s.concat(l):[s,l]}function Ae(t=[],e={}){let o,r,n,s,l;const i={_:[]};let a=0,u=0,p=0;const L=t.length,A=e.alias!==void 0,f=e.unknown!==void 0,d=e.default!==void 0;if(e.alias=e.alias||{},e.string=j(e.string),e.boolean=j(e.boolean),A)for(o in e.alias)for(r=e.alias[o]=j(e.alias[o]),a=0;a<r.length;a++)(e.alias[r[a]]=r.concat(o)).splice(a,1);for(a=e.boolean.length;a-- >0;)for(r=e.alias[e.boolean[a]]||[],u=r.length;u-- >0;)e.boolean.push(r[u]);for(a=e.string.length;a-- >0;)for(r=e.alias[e.string[a]]||[],u=r.length;u-- >0;)e.string.push(r[u]);if(d){for(o in e.default)if(s=typeof e.default[o],r=e.alias[o]=e.alias[o]||[],e[s]!==void 0)for(e[s].push(o),a=0;a<r.length;a++)e[s].push(r[a])}const w=f?Object.keys(e.alias):[];for(a=0;a<L;a++){if(n=t[a],n==="--"){i._=i._.concat(t.slice(++a));break}for(u=0;u<n.length&&n.charCodeAt(u)===45;u++);if(u===0)i._.push(n);else if(n.substring(u,u+3)==="no-"){if(s=n.slice(Math.max(0,u+3)),f&&!~w.indexOf(s))return e.unknown(n);i[s]=!1}else{for(p=u+1;p<n.length&&n.charCodeAt(p)!==61;p++);for(s=n.substring(u,p),l=n.slice(Math.max(0,++p))||a+1===L||(""+t[a+1]).charCodeAt(0)===45||t[++a],r=u===2?[s]:s,p=0;p<r.length;p++){if(s=r[p],f&&!~w.indexOf(s))return e.unknown("-".repeat(u)+s);Le(i,s,p+1<r.length||l,e)}}}if(d)for(o in e.default)i[o]===void 0&&(i[o]=e.default[o]);if(A)for(o in i)for(r=e.alias[o]||[];r.length>0;)i[r.shift()]=i[o];return i}function Se(t,e){const o={boolean:[],string:[],mixed:[],alias:{},default:{}},r=D(e);for(const i of r)i.type!=="positional"&&(i.type==="string"?o.string.push(i.name):i.type==="boolean"&&o.boolean.push(i.name),i.default!==void 0&&(o.default[i.name]=i.default),i.alias&&(o.alias[i.name]=i.alias));const n=Ae(t,o),[...s]=n._,l=new Proxy(n,{get(i,a){return i[a]??i[Ce(a)]??i[ve(a)]}});for(const[,i]of r.entries())if(i.type==="positional"){const a=s.shift();if(a!==void 0)l[i.name]=a;else{if(i.default===void 0&&i.required!==!1)throw new v(`Missing required positional argument: ${i.name.toUpperCase()}`,"EARG");l[i.name]=i.default}}else if(i.required&&l[i.name]===void 0)throw new v(`Missing required argument: --${i.name}`,"EARG");return l}function D(t){const e=[];for(const[o,r]of Object.entries(t||{}))e.push({...r,name:o,alias:ge(r.alias)});return e}function Ie(t){return t}async function q(t,e){const o=await y(t.args||{}),r=Se(e.rawArgs,o),n={rawArgs:e.rawArgs,args:r,data:e.data,cmd:t};typeof t.setup=="function"&&await t.setup(n);let s;try{const l=await y(t.subCommands);if(l&&Object.keys(l).length>0){const i=e.rawArgs.findIndex(u=>!u.startsWith("-")),a=e.rawArgs[i];if(a){if(!l[a])throw new v(`Unknown command \`${a}\``,"E_UNKNOWN_COMMAND");const u=await y(l[a]);u&&await q(u,{rawArgs:e.rawArgs.slice(i+1)})}else if(!t.run)throw new v("No command specified.","E_NO_COMMAND")}typeof t.run=="function"&&(s=await t.run(n))}finally{typeof t.cleanup=="function"&&await t.cleanup(n)}return{result:s}}async function k(t,e,o){const r=await y(t.subCommands);if(r&&Object.keys(r).length>0){const n=e.findIndex(i=>!i.startsWith("-")),s=e[n],l=await y(r[s]);if(l)return k(l,e.slice(n+1),t)}return[t,o]}async function xe(t,e){try{m.log(await Oe(t,e)+`
`)}catch(o){m.error(o)}}async function Oe(t,e){const o=await y(t.meta||{}),r=D(await y(t.args||{})),n=await y(e?.meta||{}),s=`${n.name?`${n.name} `:""}`+(o.name||process.argv[1]),l=[],i=[],a=[],u=[];for(const f of r)if(f.type==="positional"){const d=f.name.toUpperCase(),w=f.required!==!1&&f.default===void 0,C=f.default?`="${f.default}"`:"";i.push(["`"+d+C+"`",f.description||"",f.valueHint?`<${f.valueHint}>`:""]),u.push(w?`<${d}>`:`[${d}]`)}else{const d=f.required===!0&&f.default===void 0,w=(f.type==="boolean"&&f.default===!0?[...(f.alias||[]).map(C=>`--no-${C}`),`--no-${f.name}`].join(", "):[...(f.alias||[]).map(C=>`-${C}`),`--${f.name}`].join(", "))+(f.type==="string"&&(f.valueHint||f.default)?`=${f.valueHint?`<${f.valueHint}>`:`"${f.default||""}"`}`:"");l.push(["`"+w+(d?" (required)":"")+"`",f.description||""]),d&&u.push(w)}if(t.subCommands){const f=[],d=await y(t.subCommands);for(const[w,C]of Object.entries(d)){const G=await y(C),H=await y(G?.meta);a.push([`\`${w}\``,H?.description||""]),f.push(w)}u.push(f.join("|"))}const p=[],L=o.version||n.version;p.push(b.gray(`${o.description} (${s+(L?` v${L}`:"")})`),"");const A=l.length>0||i.length>0;return p.push(`${b.underline(b.bold("USAGE"))} \`${s}${A?" [OPTIONS]":""} ${u.join(" ")}\``,""),i.length>0&&(p.push(b.underline(b.bold("ARGUMENTS")),""),p.push(B(i,"  ")),p.push("")),l.length>0&&(p.push(b.underline(b.bold("OPTIONS")),""),p.push(B(l,"  ")),p.push("")),a.length>0&&(p.push(b.underline(b.bold("COMMANDS")),""),p.push(B(a,"  ")),p.push("",`Use \`${s} <command> --help\` for more information about a command.`)),p.filter(f=>typeof f=="string").join(`
`)}async function $e(t,e={}){const o=e.rawArgs||process.argv.slice(2),r=e.showUsage||xe;try{if(o.includes("--help")||o.includes("-h"))await r(...await k(t,o)),process.exit(0);else if(o.length===1&&o[0]==="--version"){const n=typeof t.meta=="function"?await t.meta():await t.meta;if(!n?.version)throw new v("No version specified","E_NO_VERSION");m.log(n.version)}else await q(t,{rawArgs:o})}catch(n){const s=n instanceof v;s||m.error(n,`
`),s&&await r(...await k(t,o)),m.error(n.message),process.exit(1)}}const Me=K(import.meta.url),Be=J(Me),je={meta:{name:"Create Reactmos Module",version:"0.1.0",description:"Create a extendable React Module"},args:{name:{type:"positional",description:"Project name",required:!0}},run({args:t}){m.info("Create consola");const e=R(process.cwd(),t.name);z(e)&&(m.error(`Dir ${t.name} alredy exists.`),process.exit(1)),V(e,{recursive:!0}),m.start("\u{1F4E6} Copying files...");const o=R(Be,"../template");Y(o,e,{recursive:!0}),m.info("\u{1F4E6} Installing depend\xEAncies..."),W(`cd ${t.name} && pnpm install`,{stdio:"inherit"}),m.success("Project created!"),m.info(`cd ${t.name} && pnpm dev`)}};$e(je);
